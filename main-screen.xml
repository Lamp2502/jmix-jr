<window xmlns="http://jmix.io/schema/ui/window"
        caption="msg://application.caption"
        xmlns:c="http://jmix.io/schema/ui/jpql-condition">
    <data>
        <instance id="userDc" class="ru.lamp2502.jmixjavarush.entity.User">
            <fetchPlan extends="_base"/>
            <loader id="userDl"/>
        </instance>
        <instance id="documentDc" class="ru.lamp2502.jmixjavarush.entity.document.Document">
            <fetchPlan extends="_base"/>
            <loader id="documentDl"/>
        </instance>
        <collection id="usersDc" class="ru.lamp2502.jmixjavarush.entity.User">
            <fetchPlan extends="_base"/>
            <loader id="usersDl">
                <query>
                    <![CDATA[select e from User e]]>
                </query>
            </loader>
        </collection>
        <collection id="documentsDc" class="ru.lamp2502.jmixjavarush.entity.document.Document">
            <fetchPlan extends="_base"/>
            <loader id="documentsDl">
                <query>
                    <![CDATA[select e from Document e]]>
                </query>
            </loader>
        </collection>
    </data>
    <actions>
        <action id="windowCommitAndClose"
                caption="msg:///actions.Ok"
                icon="EDITOR_OK"
                primary="true"
                shortcut="${COMMIT_SHORTCUT}"/>
        <action id="windowClose"
                caption="msg:///actions.Close"
                icon="EDITOR_CANCEL"/>

    </actions>
    <facets>
        <dataLoadCoordinator auto="true"/>
    </facets>

    <layout>
        <cssLayout id="mainLayoutMainMeny" width="100%" height="100%">
            <cssLayout id="headerFrame1" stylename="header-frame-1">
                <flowBox width="100%" height="100%">

                    <label id="workPlaceHeader" stylename="work-place-in-header" align="MIDDLE_LEFT"/>
                    <label id="fioInHeader" stylename="fio-in-header"/>
                    <label id="workPositionHeader" stylename="work-position-header"/>
                    <image id="fileRefImage"
                           stylename="header-avatar"
                           css="position: absolute; width:56px; height:56px; top:calc(50%-56px/2);
                           right:12px; top:12px;border-radius: 50%; border: 1px solid #fff;
                           box-shadow: 2px 1px 5px #999999;"
                           scaleMode="SCALE_DOWN"
                           alternateText="фото не установлено"
                           dataContainer="userDc"
                           property="image" align="MIDDLE_RIGHT">
                    </image>
                </flowBox>
            </cssLayout>

            <cssLayout id="horizontalWrap" stylename="side-meny">
                <cssLayout id="appTitleBox" width="100%">
                    <image id="logoImage" stylename="app-icon" scaleMode="SCALE_DOWN">
                        <resource>
                            <theme path="branding/logo.svg"/>
                        </resource>
                    </image>
                </cssLayout>
                <cssLayout id="controlBox" height="100%">
                    <vbox id="boxOfButtons" spacing="true">

                        <linkButton id="contracts"
                                    stylename="side-meny-contract-button"
                                    icon="branding/contracts.svg"
                                    caption="Договоры"/>
                        <linkButton id="documents"
                                    stylename="side-meny-contract-button"
                                    icon="branding/documents.svg"
                                    caption="Документы"/>
                        <linkButton id="tasks"
                                    stylename="side-meny-contract-button"
                                    icon="branding/tasks.svg"
                                    caption="Задачи"/>
                        <linkButton id="reports"
                                    stylename="side-meny-contract-button"
                                    icon="branding/reports.svg"
                                    caption="Отчёты"/>
                        <logoutButton id="logoutButton"
                                      stylename="side-meny-contract-button"
                                      icon="SIGN_OUT"
                                      caption="Выход"
                                      description="msg://logoutBtnDescription"/>

                        <cssLayout id="adminPanel" stylename="lower-button">
                            <userIndicator id="userIndicator"/>
                            <sideMenu id="sideMenu"
                                      width="100%"/>
                        </cssLayout>
                    </vbox>
                </cssLayout>
            </cssLayout>

            <workArea id="workArea" stylename="work-area">
                <initialLayout spacing="true" margin="true" expand="editActions">
                    <flowBox stylename="photo-on-work-area">
                        <image id="image" dataContainer="userDc" property="image" align="MIDDLE_LEFT"
                               scaleMode="SCALE_DOWN"
                               css="position: absolute; top:48px; left:40px; max-width:125px; max-height:125px;
                               display: block; border-radius: 50%; border: 2px solid #fff;
                               box-shadow: 2px 1px 5px #999999;"/>
                        <label id="fioInMainFon" stylename="fio-in-main-fon"/>
                        <label id="workplaceInMainFon" stylename="workplace-in-main-fon"
                               dataContainer="userDc" property="workplace" value="workplace"/>
                        <label id="positionMainFon" stylename="position-in-main-fon"
                               dataContainer="userDc" property="position"/>
                    </flowBox>

                    <form id="form" dataContainer="userDc" css="position: absolute; top:240px; left:40px">
                        <column width="350px">
                            <textField id="firstNameField" property="firstName"/>
                            <textField id="lastNameField" property="lastName"/>
                            <textField id="cellphoneField" property="cellphone"/>
                            <textField id="emailField" property="email"/>
                            <textField id="workphoneField" property="workphone"/>
                            <textField id="usernameField" property="username" editable="false"/>
                            <passwordField id="passwordField"
                                           caption="msg://ru.lamp2502.jmixjavarush.entity/User.password" required="true"
                                           visible="false"/>
                            <passwordField id="confirmPasswordField" caption="msg://confirmPassword"
                                           required="true" visible="false"/>
                        </column>
                    </form>
                    <hbox id="editActions" spacing="true" css="position: absolute; top:550px; left:40px">
                        <button id="commitAndCloseBtn" action="windowCommitAndClose" visible="false"/>
                        <button id="closeBtn" action="windowClose" visible="false"/>
                    </hbox>
                </initialLayout>
            </workArea>
        </cssLayout>
    </layout>
</window>